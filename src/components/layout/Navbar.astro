---
import ThemeController from './ThemeController.astro';
import LightbulbIcon from '../icons/LightbulbIcon.astro';
import MenuIcon from '../icons/MenuIcon.astro';

const navItems = [
  { href: '/', label: 'Eval' },
  { href: '/models', label: 'Models' },
  { href: '/templates', label: 'Templates' },
];

// Check current path for active state
const currentPath = Astro.url.pathname;

// Helper to check active state including sub-routes
const isActive = (href: string) => {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
};
---

<nav
  class="bg-base-100/80 backdrop-blur-xl border-b border-gold-light sticky top-0 z-50 shadow-soft"
>
  <div class="container mx-auto px-4 max-w-7xl">
    <div class="flex items-center justify-between h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-3 group transition-all hover:gap-4">
        <div class="relative">
          <LightbulbIcon class="transition-all group-hover:scale-110" size="xl" />
          <div
            class="absolute inset-0 bg-gradient-gold opacity-20 blur-md group-hover:opacity-40 transition-opacity"
          >
          </div>
        </div>
        <span
          class="hidden sm:inline font-display text-2xl font-semibold tracking-tight text-gradient-gold"
        >
          Eval AI
        </span>
      </a>

      <!-- Desktop navigation -->
      <div class="hidden lg:flex items-center gap-2">
        {
          navItems.map((item) => (
            <a
              href={item.href}
              class={`px-5 py-2.5 rounded-lg font-medium text-sm transition-all ${
                isActive(item.href)
                  ? 'bg-gradient-gold text-on-gold shadow-gold'
                  : 'text-base-content/70 hover:text-base-content hover:bg-base-200/50'
              }`}
            >
              {item.label}
            </a>
          ))
        }
      </div>

      <!-- Mobile hamburger + Theme -->
      <div class="flex items-center gap-3 lg:hidden">
        <ThemeController />
        <div class="dropdown dropdown-end">
          <div tabindex="0" role="button" class="btn btn-ghost btn-sm" aria-label="Menu">
            <MenuIcon size="md" />
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 p-3 shadow-elevated bg-base-100 rounded-xl w-52 border border-gold-light"
          >
            {
              navItems.map((item) => (
                <li>
                  <a
                    href={item.href}
                    class={
                      isActive(item.href)
                        ? 'active font-semibold bg-gradient-gold text-on-gold'
                        : 'font-medium'
                    }
                  >
                    {item.label}
                  </a>
                </li>
              ))
            }
          </ul>
        </div>
      </div>

      <!-- Desktop theme controller -->
      <div class="hidden lg:block">
        <ThemeController />
      </div>
    </div>
  </div>
</nav>
